// Multi-language support for Xiao Li Yorozuya
const translations = {
  'zh-CN': {
    // Site title and meta
    'site.name': '小李万事屋',
    'site.tagline': 'Xiao Li Yorozuya',
    'site.description': '杭州西湖区综合生活服务工作室',
    
    // Navigation
    'nav.home': '首页',
    'nav.services': '服务项目',
    'nav.about': '关于我们',
    'nav.faq': '价格与常见问题',
    'nav.contact': '联系与预约',
    
    // Language selector
    'lang.select': '语言',
    'lang.zh-CN': '简体中文',
    'lang.zh-TW': '繁體中文',
    'lang.en': 'English',
    'lang.ja': '日本語',
    
    // Common
    'common.location': '杭州 · 西湖区 · 三墩镇 · 云谷园区',
    'common.operator': 'Wentan Li',
    'common.backToTop': '回到顶部',
    'common.breadcrumb.home': '首页',
    
    // Footer
    'footer.quickLinks': '快速链接',
    'footer.contact': '联系方式',
    'footer.email': '邮箱',
    'footer.wechat': '微信',
    'footer.location': '所在地',
    'footer.notice': '温馨提示',
    'footer.noticeText': '占卜与命理相关服务仅为个人兴趣研究分享，不构成对未来结果的保证；法律相关内容仅为常识性信息与个人观点，不构成正式法律意见或律师服务。',
    'footer.copyright': '小李万事屋 Xiao Li Yorozuya. All rights reserved.',
    'footer.subtitle': 'Independent personal studio operated by Wentan Li in Hangzhou, China.',
    'footer.desc': '由 Wentan Li 个人经营的综合生活服务工作室，位于杭州市西湖区三墩镇阿里巴巴云谷园区一号楼 D 区。',
    
    // Home page
    'home.hero.kicker': '杭州 · 西湖区 · 三墩镇 · 云谷园区',
    'home.hero.title': '从算命到修车，<br />生活大小事，一家搞定。',
    'home.hero.subtitle.1': '小李万事屋是由',
    'home.hero.subtitle.2': '个人经营的小型综合服务工作室，已为周边上千位客户解决各类生活琐事与个性化需求。超过',
    'home.hero.subtitle.3': '项服务，灵活收费，透明沟通。',
    'home.hero.cta.book': '立即预约 / 咨询',
    'home.hero.cta.services': '查看全部服务项目',
    'home.hero.hours.label': '营业时间',
    'home.hero.hours.value': '工作日 10:00–20:00（节假日可预约）',
    'home.hero.address.label': '到店地址',
    'home.hero.address.value': '杭州市西湖区三墩镇，阿里巴巴云谷园区一号楼 D 区',
    'home.hero.payment.label': '支持支付',
    'home.hero.payment.value': 'VISA · PayPal · 银联 · 微信 · 支付宝',
  },
  
  'zh-TW': {
    'site.name': '小李萬事屋',
    'site.tagline': 'Xiao Li Yorozuya',
    'site.description': '杭州西湖區綜合生活服務工作室',
    
    'nav.home': '首頁',
    'nav.services': '服務項目',
    'nav.about': '關於我們',
    'nav.faq': '價格與常見問題',
    'nav.contact': '聯繫與預約',
    
    'lang.select': '語言',
    'lang.zh-CN': '简体中文',
    'lang.zh-TW': '繁體中文',
    'lang.en': 'English',
    'lang.ja': '日本語',
    
    'common.location': '杭州 · 西湖區 · 三墩鎮 · 雲谷園區',
    'common.operator': 'Wentan Li',
    'common.backToTop': '回到頂部',
    'common.breadcrumb.home': '首頁',
    
    'footer.quickLinks': '快速連結',
    'footer.contact': '聯繫方式',
    'footer.email': '郵箱',
    'footer.wechat': '微信',
    'footer.location': '所在地',
    'footer.notice': '溫馨提示',
    'footer.noticeText': '占卜與命理相關服務僅為個人興趣研究分享，不構成對未來結果的保證；法律相關內容僅為常識性信息與個人觀點，不構成正式法律意見或律師服務。',
    'footer.copyright': '小李萬事屋 Xiao Li Yorozuya. All rights reserved.',
    'footer.subtitle': 'Independent personal studio operated by Wentan Li in Hangzhou, China.',
    'footer.desc': '由 Wentan Li 個人經營的綜合生活服務工作室，位於杭州市西湖區三墩鎮阿里巴巴雲谷園區一號樓 D 區。',
    
    'home.hero.kicker': '杭州 · 西湖區 · 三墩鎮 · 雲谷園區',
    'home.hero.title': '從算命到修車，<br />生活大小事，一家搞定。',
    'home.hero.subtitle.1': '小李萬事屋是由',
    'home.hero.subtitle.2': '個人經營的小型綜合服務工作室，已為周邊上千位客戶解決各類生活瑣事與個性化需求。超過',
    'home.hero.subtitle.3': '項服務，靈活收費，透明溝通。',
    'home.hero.cta.book': '立即預約 / 諮詢',
    'home.hero.cta.services': '查看全部服務項目',
    'home.hero.hours.label': '營業時間',
    'home.hero.hours.value': '工作日 10:00–20:00（節假日可預約）',
    'home.hero.address.label': '到店地址',
    'home.hero.address.value': '杭州市西湖區三墩鎮，阿里巴巴雲谷園區一號樓 D 區',
    'home.hero.payment.label': '支持支付',
    'home.hero.payment.value': 'VISA · PayPal · 銀聯 · 微信 · 支付寶',
  },
  
  'en': {
    'site.name': 'Xiao Li Yorozuya',
    'site.tagline': 'General Services Studio',
    'site.description': 'Comprehensive Life Services Studio in Hangzhou Xihu District',
    
    'nav.home': 'Home',
    'nav.services': 'Services',
    'nav.about': 'About',
    'nav.faq': 'FAQ & Pricing',
    'nav.contact': 'Contact',
    
    'lang.select': 'Language',
    'lang.zh-CN': '简体中文',
    'lang.zh-TW': '繁體中文',
    'lang.en': 'English',
    'lang.ja': '日本語',
    
    'common.location': 'Hangzhou · Xihu · Sandun · Yungu Campus',
    'common.operator': 'Wentan Li',
    'common.backToTop': 'Back to Top',
    'common.breadcrumb.home': 'Home',
    
    'footer.quickLinks': 'Quick Links',
    'footer.contact': 'Contact',
    'footer.email': 'Email',
    'footer.wechat': 'WeChat',
    'footer.location': 'Location',
    'footer.notice': 'Notice',
    'footer.noticeText': 'Fortune-telling and divination services are personal interest sharing only and do not guarantee future results; legal content is informational only and does not constitute formal legal advice or attorney services.',
    'footer.copyright': 'Xiao Li Yorozuya. All rights reserved.',
    'footer.subtitle': 'Independent personal studio operated by Wentan Li in Hangzhou, China.',
    'footer.desc': 'A comprehensive life services studio personally operated by Wentan Li, located at Alibaba Yungu Campus Building 1, Area D, Sandun Town, Xihu District, Hangzhou.',
    
    'home.hero.kicker': 'Hangzhou · Xihu · Sandun · Yungu Campus',
    'home.hero.title': 'From Fortune-Telling to Bike Repairs,<br />All Life Matters, One Place.',
    'home.hero.subtitle.1': 'Xiao Li Yorozuya is a small comprehensive services studio personally operated by',
    'home.hero.subtitle.2': ', having helped thousands of customers solve daily life matters and personalized needs. Over',
    'home.hero.subtitle.3': 'services, flexible pricing, transparent communication.',
    'home.hero.cta.book': 'Book Now / Inquire',
    'home.hero.cta.services': 'View All Services',
    'home.hero.hours.label': 'Hours',
    'home.hero.hours.value': 'Weekdays 10:00–20:00 (Holidays by appointment)',
    'home.hero.address.label': 'Address',
    'home.hero.address.value': 'Alibaba Yungu Campus, Building 1, Area D, Sandun Town, Xihu District, Hangzhou',
    'home.hero.payment.label': 'Payment',
    'home.hero.payment.value': 'VISA · PayPal · UnionPay · WeChat · Alipay',
  },
  
  'ja': {
    'site.name': '小李万事屋',
    'site.tagline': 'Xiao Li Yorozuya',
    'site.description': '杭州西湖区総合生活サービススタジオ',
    
    'nav.home': 'ホーム',
    'nav.services': 'サービス',
    'nav.about': '私たちについて',
    'nav.faq': '料金とよくある質問',
    'nav.contact': 'お問い合わせ',
    
    'lang.select': '言語',
    'lang.zh-CN': '简体中文',
    'lang.zh-TW': '繁體中文',
    'lang.en': 'English',
    'lang.ja': '日本語',
    
    'common.location': '杭州 · 西湖区 · 三墩鎮 · 雲谷キャンパス',
    'common.operator': 'Wentan Li',
    'common.backToTop': 'トップへ',
    'common.breadcrumb.home': 'ホーム',
    
    'footer.quickLinks': 'クイックリンク',
    'footer.contact': 'お問い合わせ',
    'footer.email': 'メール',
    'footer.wechat': 'WeChat',
    'footer.location': '所在地',
    'footer.notice': 'ご注意',
    'footer.noticeText': '占いや命理に関するサービスは個人的な興味研究の共有であり、将来の結果を保証するものではありません。法律関連の内容は常識的な情報と個人的な意見であり、正式な法的助言や弁護士サービスを構成するものではありません。',
    'footer.copyright': '小李万事屋 Xiao Li Yorozuya. All rights reserved.',
    'footer.subtitle': 'Independent personal studio operated by Wentan Li in Hangzhou, China.',
    'footer.desc': 'Wentan Liが個人運営する総合生活サービススタジオ、杭州市西湖区三墩鎮アリババ雲谷キャンパス1号棟Dエリアに所在。',
    
    'home.hero.kicker': '杭州 · 西湖区 · 三墩鎮 · 雲谷キャンパス',
    'home.hero.title': '占いから自転車修理まで、<br />生活のあらゆること、ここで解決。',
    'home.hero.subtitle.1': '小李万事屋は',
    'home.hero.subtitle.2': 'が個人運営する小規模総合サービススタジオで、周辺の何千人ものお客様の日常の雑事や個性的なニーズを解決してきました。',
    'home.hero.subtitle.3': '以上のサービス、柔軟な料金設定、透明なコミュニケーション。',
    'home.hero.cta.book': 'ご予約 / お問い合わせ',
    'home.hero.cta.services': '全サービスを見る',
    'home.hero.hours.label': '営業時間',
    'home.hero.hours.value': '平日 10:00–20:00（祝日は予約制）',
    'home.hero.address.label': '所在地',
    'home.hero.address.value': '杭州市西湖区三墩鎮、アリババ雲谷キャンパス1号棟Dエリア',
    'home.hero.payment.label': 'お支払い',
    'home.hero.payment.value': 'VISA · PayPal · 銀聯 · WeChat · Alipay',
  }
};

// Language manager
class I18n {
  constructor() {
    this.currentLang = this.detectLanguage();
    this.loadLanguage(this.currentLang);
  }
  
  detectLanguage() {
    // Check localStorage first
    const saved = localStorage.getItem('yorozuya-lang');
    if (saved && translations[saved]) {
      return saved;
    }
    
    // Check browser language
    const browserLang = navigator.language || navigator.userLanguage;
    if (browserLang.startsWith('zh')) {
      if (browserLang.includes('TW') || browserLang.includes('HK')) {
        return 'zh-TW';
      }
      return 'zh-CN';
    } else if (browserLang.startsWith('ja')) {
      return 'ja';
    } else if (browserLang.startsWith('en')) {
      return 'en';
    }
    
    // Default to Simplified Chinese
    return 'zh-CN';
  }
  
  loadLanguage(lang) {
    if (!translations[lang]) {
      lang = 'zh-CN';
    }
    
    this.currentLang = lang;
    localStorage.setItem('yorozuya-lang', lang);
    
    // Update html lang attribute
    document.documentElement.lang = lang;
    
    // Translate all elements with data-i18n attribute
    this.translatePage();
    
    // Update language selector
    this.updateLanguageSelector();
  }
  
  translatePage() {
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
      const key = el.getAttribute('data-i18n');
      const translation = this.t(key);
      
      if (translation) {
        // Check if element should use innerHTML (for HTML content like <br>)
        if (el.hasAttribute('data-i18n-html')) {
          el.innerHTML = translation;
        } else {
          el.textContent = translation;
        }
      }
    });
    
    // Update placeholders
    const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
    placeholders.forEach(el => {
      const key = el.getAttribute('data-i18n-placeholder');
      const translation = this.t(key);
      if (translation) {
        el.placeholder = translation;
      }
    });
    
    // Update aria-labels
    const ariaLabels = document.querySelectorAll('[data-i18n-aria]');
    ariaLabels.forEach(el => {
      const key = el.getAttribute('data-i18n-aria');
      const translation = this.t(key);
      if (translation) {
        el.setAttribute('aria-label', translation);
      }
    });
  }
  
  t(key) {
    return translations[this.currentLang]?.[key] || translations['zh-CN']?.[key] || key;
  }
  
  switchLanguage(lang) {
    this.loadLanguage(lang);
  }
  
  updateLanguageSelector() {
    const selector = document.querySelector('.lang-selector');
    if (selector) {
      const buttons = selector.querySelectorAll('[data-lang]');
      buttons.forEach(btn => {
        const btnLang = btn.getAttribute('data-lang');
        if (btnLang === this.currentLang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
    }
  }
}

// Initialize when DOM is ready
let i18n;
document.addEventListener('DOMContentLoaded', () => {
  i18n = new I18n();
  
  // Set up language selector event listeners
  const langButtons = document.querySelectorAll('[data-lang]');
  langButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const lang = btn.getAttribute('data-lang');
      i18n.switchLanguage(lang);
    });
  });
});
